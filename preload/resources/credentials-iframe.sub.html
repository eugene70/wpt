<!DOCTYPE html>
<meta charset="utf-8">

<link rel="modulepreload" href="check-cookie.py?id=sameOriginNone&cookieName=same">
<link rel="modulepreload" href="check-cookie.py?id=sameOriginAnonymous&cookieName=same" crossorigin="anonymous">
<link rel="modulepreload" href="check-cookie.py?id=sameOriginUseCredentials&cookieName=same" crossorigin="use-credentials">
<link rel="modulepreload" href="http://{{domains[www2]}}:{{ports[http][0]}}/preload/resources/check-cookie.py?id=crossOriginNone&cookieName=cross">
<link rel="modulepreload" href="http://{{domains[www2]}}:{{ports[http][0]}}/preload/resources/check-cookie.py?id=crossOriginAnonymous&cookieName=cross" crossorigin="anonymous">
<link rel="modulepreload" href="http://{{domains[www2]}}:{{ports[http][0]}}/preload/resources/check-cookie.py?id=crossOriginUseCredentials&cookieName=cross" crossorigin="use-credentials">

<script type=module></script>
<script type=module crossorigin="anonymous"></script>
<script type=module crossorigin="use-credentials"></script>
<script type=module></script>
<script type=module crossorigin="anonymous"></script>
<script type=module crossorigin="use-credentials"></script>

<script>
const URLs = [
  "check-cookie.py?id=sameOriginNone&cookieName=same",
  "check-cookie.py?id=sameOriginAnonymous&cookieName=same",
  "check-cookie.py?id=sameOriginUseCredentials&cookieName=same",
  "http://{{domains[www2]}}:{{ports[http][0]}}/preload/resources/check-cookie.py?id=crossOriginNone&cookieName=cross",
  "http://{{domains[www2]}}:{{ports[http][0]}}/preload/resources/check-cookie.py?id=crossOriginAnonymous&cookieName=cross",
  "http://{{domains[www2]}}:{{ports[http][0]}}/preload/resources/check-cookie.py?id=crossOriginUseCredentials&cookieName=cross"
];

const modulepreloadPromises = Array.from(document.querySelectorAll('link')).map(link => {
  return new Promise((resolve, reject) => {
    link.onload = resolve;
  });
});

let i = 0;
const scriptPromises = Array.from(document.querySelectorAll('script[type=module]')).map(script => {
  script.src = URLs[i++];
  return new Promise((resolve, reject) => {
    script.onload = resolve;
  });
});

Promise.all([...modulepreloadPromises, ...scriptPromises]).then(() => {
  window.parent.postMessage({}, '*');
});
</script>
